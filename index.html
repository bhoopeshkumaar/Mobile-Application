<!DOCTYPE html> 
<html> 
<head> 
	<title>VIGIL</title> 
	<meta name="viewport" content="width=device-width, initial-scale=1"> 
	<link rel="stylesheet" href="css/jquery.mobile142.css" />
	<link rel="stylesheet" href="css/map.css" />
	<script src="js/jquery191.js"></script>
	<!--<script type="text/javascript" src="js/google_maps.js"></script>-->
	<script type="text/javascript" src="https://maps.googleapis.com/maps/api/js?key=AIzaSyCyq28yaQFLLi9tGHaNGMsaA9WQy7yzbVE"></script>
	<script type="text/javascript" src="js/Chart.js"></script>
	
	<script>
    $(document).bind('mobileinit',function(){
        $.mobile.pushStateEnabled = false;
    });
	</script>
	<script src="js/jquery.mobile142.js"></script>
	
	<script src="js/db_map.js"></script>
	<script>
	
	$( document ).on( "pagebeforeshow", "#map-page", function() {
		reset();
		$('#eventMap').hide();
	});
	
	$( document ).on( "pageshow", "#map-page", function() {
		showMap();
		getUserLocation();
	});
	
	$( document ).on( "pageinit", "#page1", function() {
		initDatabase();
		getUserLocation();
	});
	
	$( document ).on( "pagebeforeshow", "#page1", function() {
		getUserLocation();
	});
	
	$( document ).on( "pageshow", "#page1", function() {
		selectNews();
	});
	
	$( document ).on( "pageshow", "#page4", function() {
		selectUser();
	});
	
	
	$( document ).on( "change", "#radio-addr-1", function(e) {
			$('#eventMap').show();
	});
	
	$( document ).on( "change", "#radio-addr-2", function(e) {
			$('#eventMap').hide();
	});
	
	$(document).on( "pagebeforeshow", "#cityTrendChartPage", function() {
		getCityDataCount();
	});
	
	$(document).on( "pageshow", "#cityTrendChartPage", function() {
			drawBarChart("cityTrendChart");
	});
	  
	$(document).on( "pagebeforeshow", "#emergencyTrendChartPage", function() {
		getCityDataCount();
		getEmergencyMap();
	});
	
	$(document).on( "pageshow", "#emergencyTrendChartPage", function() {
			drawPieBarChart();
	});
	    
	$(document).on("click", "#emergencyTrendPieChart", function (e){
		updateBarChart(e);
	});
	  
	</script>
</head> 
<body> 
	
	<div data-role="page" id="page1">
		<div data-role="header" data-theme="b">
			<h1><img src="images/logo1.png"/></h1>
			<div data-role="navbar">
				<ul>
					<li><a href="#page1" data-icon="info">News Feed</a></li>
					<li><a href="#map-page" data-icon="location">Notify</a></li>
					<li><a href="#page2" data-icon="eye">Analytics</a></li>
					<li><a href="#page3" data-icon="mail">Contact</a></li>
					<li><a href="#page4" data-icon="user">User Profile</a></li>
					
				</ul>
			</div>
		</div>
		<div data-role="main" class="ui-content">
			<h1>Active news</h1>
			<div data-role="collapsible-set" data-content-theme="d" id="set"></div>
			
		</div>
		<div data-role="footer" data-theme="b" data-position="fixed" data-hide-during-focus="" data-tap-toggle="false">
			<h2>&copy; MIM Team 2014</h2>
		</div>	
	</div>
	
	<div data-role="page" id="map-page" data-url="map-page">
		<div data-role="header" data-theme="b">
			<h1><img src="images/logo1.png"/></h1>
			<div data-role="navbar">
				<ul>
					<li><a href="#page1" data-icon="info">News Feed</a></li>
					<li><a href="#map-page" data-icon="location">Notify</a></li>
					<li><a href="#page2" data-icon="eye">Analytics</a></li>
					<li><a href="#page3" data-icon="mail">Contact</a></li>
					<li><a href="#page4" data-icon="user">User Profile</a></li>
				</ul>
			</div>
		</div>
		<div role="main" class="ui-content" id="map-canvas" align="center"></div><!--Map loads here-->
		<div id="currentLocation"></div>
		<div id="notifyform">
			<fieldset data-role="controlgroup">
					<legend>Choose an emergency type:</legend>
					<input type="radio" name="radio-choice" id="radio-choice-1" value="Theft" />
					<label for="radio-choice-1">Theft</label>

					<input type="radio" name="radio-choice" id="radio-choice-2" value="Fire"  />
					<label for="radio-choice-2">Fire</label>

					<input type="radio" name="radio-choice" id="radio-choice-3" value="Medical"  />
					<label for="radio-choice-3">Medical</label>

					<input type="radio" name="radio-choice" id="radio-choice-4" value="Other"  />
					<label for="radio-choice-4">Other</label>
			</fieldset>
				
				<label for="textarea-a">Description:</label>
				<textarea name="textarea" id="description">
				</textarea>
				
				<fieldset data-role="controlgroup" id="addrFieldSet">
					<legend>Do you want to enter the exact address:</legend>
					<input type="radio" name="radio-choice-exactaddr" id="radio-addr-1" value="yes"  />
					<label for="radio-addr-1">Yes</label>

					<input type="radio" name="radio-choice-exactaddr" id="radio-addr-2" value="no" />
					<label for="radio-addr-2">No</label>
				</fieldset>
				
				<div id="eventMap">
					<div data-role="fieldcontain">
						<label for="name">Address:</label>
						<input type="text" name="address" id="address" value="" placeholder="Building number, street name  and city is needed"/>
					</div>
				</div>
				
				
				<a href="#popupInfodiv" id="notify_btn"  data-rel="popup" class="ui-btn ui-btn-inline ui-corner-all ui-icon-check ui-btn-icon-left" onclick="return addNewsIntoDB();">Notify</a>
				<div id ="popupInfodiv" data-role="popup" class="ui-content" style="min-width:250px;"> 
						<h5>Thanks for your information. Concerned authorities will take immediate action. Once again thanks for your time.</h5>
						<a href="#map-page" id="cancel_btn" class="ui-btn ui-btn-inline ui-corner-all ui-icon-check ui-btn-icon-left" >Close</a>
				</div>
				<!--<input type="button" value="Notify" id="notify_btn"  data-inline="true" data-role="button">-->
				<!--<input type="button" value="LAt_Long" id="lat_long_btn">-->
				
		</div>
		<div data-role="footer" data-theme="b" data-position="fixed" data-hide-during-focus="" data-tap-toggle="false">
			<h2>&copy; MIM Team 2014</h2>
		</div>
	</div>

	<div data-role="page" id="page2">
		<div data-role="header" data-theme="b">
			<h1><img src="images/logo1.png"/></h1>
			<div data-role="navbar">
				<ul>
					<li><a href="#page1" data-icon="info">News Feed</a></li>
					<li><a href="#map-page" data-icon="location">Notify</a></li>
					<li><a href="#page2" data-icon="eye">Analytics</a></li>
					<li><a href="#page3" data-icon="mail">Contact</a></li>
					<li><a href="#page4" data-icon="user">User Profile</a></li>
				</ul>
			</div>
		</div>
		
			
			<div data-role="content" id = "chart">
				<h1>Analytics</h1>
				<ul data-role="listview" data-filter="false" data-inset="true" data-theme="c" data-divider-theme="b"> <!-- TODO Try adding data divider -->
					<li><a href="#cityTrendChartPage" data-transition="pop">City Trend</a></li>
					<li><a href="#emergencyTrendChartPage" data-transition="pop">Emergency Trend</a></li>
					<li><a href="#bubbleChart" data-transition="pop">Bubble Viz.</a></li>
				</ul>
			</div>
			<div data-role="footer" data-theme="b" data-position="fixed" data-hide-during-focus="" data-tap-toggle="false">
				<h2>&copy; MIM Team 2014</h2>
			</div>	
		</div>
		
	
	
	<div data-role="page" id="page3">
		<div data-role="header" data-theme="b">
			<h1><img src="images/logo1.png"/></h1>
			<div data-role="navbar">
				<ul>
					<li><a href="#page1" data-icon="info">News Feed</a></li>
					<li><a href="#map-page" data-icon="location">Notify</a></li>
					<li><a href="#page2" data-icon="eye">Analytics</a></li>
					<li><a href="#page3" data-icon="mail">Contact</a></li>
					<li><a href="#page4" data-icon="user">User Profile</a></li>
				</ul>
			</div>
		</div>
		<div data-role="main" class="ui-content">
			<h1>Contact page</h1>
		</div>
		<div data-role="footer" data-theme="b" data-position="fixed" data-hide-during-focus="" data-tap-toggle="false">
			<h2>&copy; MIM Team 2014</h2>
		</div>	
	</div>
	
	<div data-role="page" id="page4">
		<div data-role="header" data-theme="b">
			<h1><img src="images/logo1.png"/></h1>
			<div data-role="navbar">
				<ul>
					<li><a href="#page1" data-icon="info">News Feed</a></li>
					<li><a href="#map-page" data-icon="location">Notify</a></li>
					<li><a href="#page2" data-icon="eye">Analytics</a></li>
					<li><a href="#page3" data-icon="mail">Contact</a></li>
					<li><a href="#page4" data-icon="user">User Profile</a></li>
				</ul>
			</div>
		</div>
		<div data-role="main" class="ui-content">
			<h1>User profile</h1>
			<div id="user_n"></div>
			
		
			
		</div>
		<div data-role="footer" data-theme="b" data-position="fixed" data-hide-during-focus="" data-tap-toggle="false">
			<h2>&copy; MIM Team 2014</h2>
		</div>	
	</div>
	
	<!-- Chart Divs -->
	
	<div data-role="page" id="cityTrendChartPage">
		<div data-role="header" data-theme="b">
			<h1><img src="images/logo1.png"/></h1>
			<div data-role="navbar">
				<ul>
					<li><a href="#page1" data-icon="info">News Feed</a></li>
					<li><a href="#map-page" data-icon="location">Notify</a></li>
					<li><a href="#page2" data-icon="eye">Analytics</a></li>
					<li><a href="#page3" data-icon="mail">Contact</a></li>
					<li><a href="#page4" data-icon="user">User Profile</a></li>
				</ul>
			</div>
		</div>
		<div data-role="main" class="ui-content">
				<a href="#page2" data-transition="slide" data-role="button" data-inline="true">Back</a> <!-- TODO make it smaller -->
				<h2 align="center">City Trends</h2>
				<canvas id="cityTrendChart" height="300" width="300"></canvas>
		</div>
		<div data-role="footer" data-theme="b" data-position="fixed" data-hide-during-focus="" data-tap-toggle="false">
			<h2>&copy; MIM Team 2014</h2>
		</div>	
	</div>
	
	
	<div data-role="page" id="emergencyTrendChartPage">
		<div data-role="header" data-theme="b">
			<h1><img src="images/logo1.png"/></h1>
			<div data-role="navbar">
				<ul>
					<li><a href="#page1" data-icon="info">News Feed</a></li>
					<li><a href="#map-page" data-icon="location">Notify</a></li>
					<li><a href="#page2" data-icon="eye">Analytics</a></li>
					<li><a href="#page3" data-icon="mail">Contact</a></li>
					<li><a href="#page4" data-icon="user">User Profile</a></li>
				</ul>
			</div>
		</div>
		<div data-role="main" class="ui-content">
				<a href="#page2" data-transition="slide" data-role="button" data-inline="true">Back</a> <!-- TODO make it smaller -->
				<h2 align="center">Emergency Trends</h2>
				<div align="center">
					<canvas id="emergencyTrendPieChart" height="200" width="200" align="center"></canvas>
					<canvas id="emergencyTrendBarChart" height="200" width="200" align="center"></canvas>
				</div>
		</div>
		<div data-role="footer" data-theme="b" data-position="fixed" data-hide-during-focus="" data-tap-toggle="false">
			<h2>&copy; MIM Team 2014</h2>
		</div>	
	</div>
	
</body>
</html>